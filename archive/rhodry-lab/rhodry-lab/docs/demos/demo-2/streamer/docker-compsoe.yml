version: '3.7'

x-common: &common
  image: registry-git.digikala.com/bi/bikafka:streamer
  secrets:
    - DG_SHARED_ADDR
    - DG_SHARED_PORT
    - DG_SHARED_USER
    - DG_SHARED_PASS
  networks:
    - bikafka

services:
  orders:
    <<: *common
    command: stream.py --table orders --interval 30 --lag 0
  order_items:
    <<: *common
    command: stream.py --table order_items --interval 30 --lag 15
  # order_item_serials:
    # <<: *common
    # command: stream.py --table order_item_serials --interval 30

networks:
  bikafka:
    external: true

secrets:
  DG_SHARED_ADDR:
    external: true
  DG_SHARED_PORT:
    external: true
  DG_SHARED_USER:
    external: true
  DG_SHARED_PASS:
    external: true
